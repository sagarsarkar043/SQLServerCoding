--Group By Clause

--Q1. Find total number of orders placed by each customer
SELECT 
    CustomerID,
    COUNT(OrderID) AS TotalOrders
FROM Orders
GROUP BY CustomerID;

--Q2. Find total quantity sold for each product
SELECT 
    ProductID,
    SUM(Quantity) AS TotalQuantitySold
FROM Orders
GROUP BY ProductID;

--Q3. Find average quantity ordered per product
SELECT 
    ProductID,
    AVG(Quantity) AS AvgQuantity
FROM Orders
GROUP BY ProductID;

--Q4. Find maximum and minimum quantity ordered for each product
SELECT 
    ProductID,
    MAX(Quantity) AS MaxQty,
    MIN(Quantity) AS MinQty
FROM Orders
GROUP BY ProductID;

--Q5. Find total sales value generated by each product

--(Quantity Ã— Price)

SELECT 
    P.ProductName,
    SUM(O.Quantity * P.Price) AS TotalSalesValue
FROM Orders O
JOIN Products P
    ON O.ProductID = P.ProductID
GROUP BY P.ProductName;

--Q6. Find total revenue generated by each customer
SELECT 
    C.CustomerName,
    SUM(O.Quantity * P.Price) AS TotalRevenue
FROM Orders O
JOIN Customers C
    ON O.CustomerID = C.CustomerID
JOIN Products P
    ON O.ProductID = P.ProductID
GROUP BY C.CustomerName;

--Q7. Find number of orders placed per month
SELECT 
    MONTH(OrderDate) AS OrderMonth,
    COUNT(OrderID) AS TotalOrders
FROM Orders
GROUP BY MONTH(OrderDate);

--Find average discount offered per product
SELECT 
    ProductID,
    AVG(DiscountPercent) AS AvgDiscount
FROM Orders
GROUP BY ProductID;

--Q9. Find customers who have placed more than 1 order

--(GROUP BY + HAVING)

SELECT 
    CustomerID,
    COUNT(OrderID) AS TotalOrders
FROM Orders
GROUP BY CustomerID
HAVING COUNT(OrderID) > 1;

--Q10. Find products whose total quantity sold is greater than 3
SELECT 
    ProductID,
    SUM(Quantity) AS TotalQuantity
FROM Orders
GROUP BY ProductID
HAVING SUM(Quantity) > 3;
